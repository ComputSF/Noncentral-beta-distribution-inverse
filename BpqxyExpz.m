function Bpq=BpqxyExpz(x,y,p,q)
%-----------------------------------------------
%Large z expansion.
%To be used for 0 < y <= 1-delta, delta a fixed 
%positive small number.
%-----------------------------------------------
pmq=p+q;
P1=1-pmq;
P2=1+P1;
P3=1+P2;
P4=1+P3;
P5=1+P4;
P6=1+P5;
P7=1+P6;
P8=1+P7;
P9=1+P8;
P10=1+P9;
P11=1+P10;
P12=1+P11;
P13=1+P12;
P14=1+P13;
P15=1+P14;
yn=1-y;
yn2=yn*yn;
yn3=yn2*yn;
yn4=yn3*yn;
yn5=yn4*yn;
yn6=yn5*yn;
yn7=yn6*yn;
yn8=yn7*yn;
yn9=yn8*yn;
yn10=yn9*yn;
yn11=yn10*yn;
yn12=yn11*yn;
yn13=yn12*yn;
yn14=yn13*yn;
yn15=yn14*yn;
y2=y*y;
y3=y2*y;
y4=y3*y;
y5=y4*y;
y6=y5*y;
y7=y6*y;
y8=y7*y;
y9=y8*y;
y10=y9*y;
y11=y10*y;
y12=y11*y;
y13=y12*y;
y14=y13*y;
y15=y14*y;
z=x*y/2;
coe1=1/2;
coe2=1/6;
coe3=1/24;
coe4=1/120;
coe5=1/720;
coe6=1/5040;
coe7=1/40320;
coe8=1/362880;
coe9=1/3628800;
coe10=1/39916800;
coe11=1/479001600;
coe12=1/6227020800;
coe13=1/87178291200;
c(1)= y/yn-P1;
c(2)= y2/yn2+(-P1)*y/yn+coe1*P1*P2;
c(3)= y3/yn3+(-P1)*y2/yn2+coe1*P1*P2*y/yn-coe2*P1*P2*P3;
c(4)= y4/yn4+(-P1)*y3/yn3+coe1*P1*P2*y2/yn2-coe2*P1*P2*P3*y/yn+...
      coe3*P1*P2*P3*P4;
c(5)= y5/yn5+(-P1)*y4/yn4+coe1*P1*P2*y3/yn3-coe2*P1*P2*P3*y2/yn2+...
      coe3*P1*P2*P3*P4*y/yn-coe4*P1*P2*P3*P4*P5;
c(6)= y6/yn6+(-P1)*y5/yn5+coe1*P1*P2*y4/yn4-coe2*P1*P2*P3*y3/yn3+...
      coe3*P1*P2*P3*P4*y2/yn2-coe4*P1*P2*P3*P4*P5*y/yn+...
      coe5*P1*P2*P3*P4*P5*P6;
c(7)= y7/yn7+(-P1)*y6/yn6+coe1*P1*P2*y5/yn5-coe2*P1*P2*P3*y4/yn4+...
      coe3*P1*P2*P3*P4*y3/yn3-coe4*P1*P2*P3*P4*P5*y2/yn2+...
      coe5*P1*P2*P3*P4*P5*P6*y/yn-coe6*P1*P2*P3*P4*P5*P6*P7;
c(8)= y8/yn8+(-P1)*y7/yn7+coe1*P1*P2*y6/yn6-coe2*P1*P2*P3*y5/yn5+...
      coe3*P1*P2*P3*P4*y4/yn4-coe4*P1*P2*P3*P4*P5*y3/yn3+...
      coe5*P1*P2*P3*P4*P5*P6*y2/yn2-...
      coe6*P1*P2*P3*P4*P5*P6*P7*y/yn+...
      coe7*P1*P2*P3*P4*P5*P6*P7*P8;
c(9)= y9/yn9+(-P1)*y8/yn8+coe1*P1*P2*y7/yn7-coe2*P1*P2*P3*y6/yn6+...
      coe3*P1*P2*P3*P4*y5/yn5-coe4*P1*P2*P3*P4*P5*y4/yn4+...
      coe5*P1*P2*P3*P4*P5*P6*y3/yn3-...
      coe6*P1*P2*P3*P4*P5*P6*P7*y2/yn2+...
      coe7*P1*P2*P3*P4*P5*P6*P7*P8*y/yn-...
      coe8*P1*P2*P3*P4*P5*P6*P7*P8*P9;
c(10)= y10/yn10+(-P1)*y9/yn9+coe1*P1*P2*y8/yn8-...
      coe2*P1*P2*P3*y7/yn7+coe3*P1*P2*P3*P4*y6/yn6-...
      coe4*P1*P2*P3*P4*P5*y5/yn5+...
      coe5*P1*P2*P3*P4*P5*P6*y4/yn4-...
      coe6*P1*P2*P3*P4*P5*P6*P7*y3/yn3+...
      coe7*P1*P2*P3*P4*P5*P6*P7*P8*y2/yn2-...
      coe8*P1*P2*P3*P4*P5*P6*P7*P8*P9*y/yn+...
      coe9*P1*P2*P3*P4*P5*P6*P7*P8*P9*P10;
c(11)= y11/yn11+(-P1)*y10/yn10+coe1*P1*P2*y9/yn9-coe2*P1*P2*P3*y8/yn8+...
       coe3*P1*P2*P3*P4*y7/yn7-...
       coe4*P1*P2*P3*P4*P5*y6/yn6+...
       coe5*P1*P2*P3*P4*P5*P6*y5/yn5-...
       coe6*P1*P2*P3*P4*P5*P6*P7*y4/yn4+...
       coe7*P1*P2*P3*P4*P5*P6*P7*P8*y3/yn3-...
       coe8*P1*P2*P3*P4*P5*P6*P7*P8*P9*y2/yn2+...
       coe9*P1*P2*P3*P4*P5*P6*P7*P8*P9*P10*y/yn-...
       coe10*P1*P2*P3*P4*P5*P6*P7*P8*P9*P10*P11;
c(12)= y12/yn12+(-P1)*y11/yn11+coe1*P1*P2*y10/yn10-coe2*P1*P2*P3*y9/yn9+...
       coe3*P1*P2*P3*P4*y8/yn8-coe4*P1*P2*P3*P4*P5*y7/yn7+...
       coe5*P1*P2*P3*P4*P5*P6*y6/yn6-...
       coe6*P1*P2*P3*P4*P5*P6*P7*y5/yn5+...
       coe7*P1*P2*P3*P4*P5*P6*P7*P8*y4/yn4-...
       coe8*P1*P2*P3*P4*P5*P6*P7*P8*P9*y3/yn3+...
       coe9*P1*P2*P3*P4*P5*P6*P7*P8*P9*P10*y2/yn2-...
       coe10*P1*P2*P3*P4*P5*P6*P7*P8*P9*P10*P11*y/yn+...
       coe11*P1*P2*P3*P4*P5*P6*P7*P8*P9*P10*P11*P12;
c(13)= y13/yn13+(-P1)*y12/yn12+coe1*P1*P2*y11/yn11-coe2*P1*P2*P3*y10/yn10+...
       coe3*P1*P2*P3*P4*y9/yn9-coe4*P1*P2*P3*P4*P5*y8/yn8+...
       coe5*P1*P2*P3*P4*P5*P6*y7/yn7-...
       coe6*P1*P2*P3*P4*P5*P6*P7*y6/yn6+...
       coe7*P1*P2*P3*P4*P5*P6*P7*P8*y5/yn5-...
       coe8*P1*P2*P3*P4*P5*P6*P7*P8*P9*y4/yn4+...
       coe9*P1*P2*P3*P4*P5*P6*P7*P8*P9*P10*y3/yn3-...
       coe10*P1*P2*P3*P4*P5*P6*P7*P8*P9*P10*P11*y2/yn2+...
       coe11*P1*P2*P3*P4*P5*P6*P7*P8*P9*P10*P11*P12*y/yn-...
       coe12*P1*P2*P3*P4*P5*P6*P7*P8*P9*P10*P11*P12*P13;
c(14)= y14/yn14+(-P1)*y13/yn13+coe1*P1*P2*y12/yn12-coe2*P1*P2*P3*y11/yn11+...
       coe3*P1*P2*P3*P4*y10/yn10-coe4*P1*P2*P3*P4*P5*y9/yn9+...
       coe5*P1*P2*P3*P4*P5*P6*y8/yn8-...
       coe6*P1*P2*P3*P4*P5*P6*P7*y7/yn7+...
       coe7*P1*P2*P3*P4*P5*P6*P7*P8*y6/yn6-...
       coe8*P1*P2*P3*P4*P5*P6*P7*P8*P9*y5/yn5+...
       coe9*P1*P2*P3*P4*P5*P6*P7*P8*P9*P10*y4/yn4-...
       coe10*P1*P2*P3*P4*P5*P6*P7*P8*P9*P10*P11*y3/yn3+...
       coe11*P1*P2*P3*P4*P5*P6*P7*P8*P9*P10*P11*P12*y2/yn2-...
       coe12*P1*P2*P3*P4*P5*P6*P7*P8*P9*P10*P11*P12*P13*y/yn+...
       coe13*P1*P2*P3*P4*P5*P6*P7*P8*P9*P10*P11*P12*P13*P14;
c(15)= y15/yn15+(-P1)*y14/yn14+coe1*P1*P2*y13/yn13-coe2*P1*P2*P3*y12/yn12+...
       coe3*P1*P2*P3*P4*y11/yn11-coe4*P1*P2*P3*P4*P5*y10/yn10+...
       coe5*P1*P2*P3*P4*P5*P6*y9/yn9-...
       coe6*P1*P2*P3*P4*P5*P6*P7*y8/yn8+...
       coe7*P1*P2*P3*P4*P5*P6*P7*P8*y7/yn7-...
       coe8*P1*P2*P3*P4*P5*P6*P7*P8*P9*y6/yn6+...
       coe9*P1*P2*P3*P4*P5*P6*P7*P8*P9*P10*y5/yn5-...
       coe10*P1*P2*P3*P4*P5*P6*P7*P8*P9*P10*P11*y4/yn4+...
       coe11*P1*P2*P3*P4*P5*P6*P7*P8*P9*P10*P11*P12*y3/yn3-...
       coe12*P1*P2*P3*P4*P5*P6*P7*P8*P9*P10*P11*P12*P13*y2/yn2+...
       coe13*P1*P2*P3*P4*P5*P6*P7*P8*P9*P10*P11*P12*P13*P14*y/yn-...
       (1/1307674368000)*P1*P2*P3*P4*P5*P6*P7*P8*P9*P10*P11*P12*P13*P14*P15;
suma=1;
zn=1;
n=0;
pochterm=1;
while n<15
  pochterm=pochterm*(1-q+n); 
  n=n+1;  
  zn=-zn*z;	
  term=pochterm*c(n)/zn;
  suma=suma+term;
end
Bfac=exp(-x/2+z)*y^p*yn^(q-1)*z^(q-1)/gamma(q);
Bpq=Bfac*suma;
end